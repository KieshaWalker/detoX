{% extends 'first_contact/base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block content %}
{% if not user.is_authenticated %}
<section class="login-section">
  <h2>Welcome Back</h2>
  <p>Sign in to your detoX account to continue your journey.</p>

  <form action="{% url 'login' %}" method="post" class="login-form">
    {% csrf_token %}
    <div class="form-group">
      <label for="id_username">Username:</label>
      {{ form.username }}
    </div>
    <div class="form-group">
      <label for="id_password">Password:</label>
      {{ form.password }}
    </div>
    <input type="hidden" name="next" value="{{ next }}" />
    <button type="submit" class="btn btn-primary">Sign In</button>
  </form>

  {% if form.errors %}
  <div class="messages">
    {% for field, errors in form.errors.items %}
    {% for error in errors %}
    <div class="message error">
      {{ error }}
    </div>
    {% endfor %}
    {% endfor %}
    {% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
    <div class="message error">
      {{ error }}
    </div>
    {% endfor %}
    {% endif %}
  </div>
  {% endif %}

  <div class="login-links">
    <a href="{% url 'register' %}">Need an invitation code?</a>
  </div>
</section>
{% else %}
<section class="welcome-back">
  <h3>You're already signed in!</h3>
  <p>Welcome back, {{ user.username }}. <a href="{% url 'home' %}">Go to your dashboard</a>.</p>
</section>
{% endif %}
{% endblock %}